<!-- Copyright 2022 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License. -->
<!DOCTYPE html>
<html>
    <head>
        <title>Noise Lab</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script type="module" src="js/main.js" defer></script>
        <script type="module" src="js/laplace.js" defer></script>
        <script type="module" src="js/simple-mode.js" defer></script>
        <script type="module" src="js/tooltips.js" defer></script>
        <link rel="stylesheet" href="./style.css" />
        <link href="./third_party/tabulator.min.css" rel="stylesheet" />
        <link
            rel="icon"
            href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß™</text></svg>"
        />
    </head>
    <body>
        <div id="menu">
            <nav id="nav">
                <div>
                    üß™ Noise Lab
                    <div class="version">v1.0.2</div>
                </div>

                <!-- Populated automatically, see main.js -->
            </nav>
            <div class="buttons-wrapper-nav">
                <button class="secondary">
                    <a
                        target="_blank"
                        href="https://github.com/WICG/attribution-reporting-api/issues/485"
                    >
                        Give feedback
                    </a>
                </button>
                <button id="feedback-button" class="secondary">
                    <a
                        target="_blank"
                        href="https://docs.google.com/document/d/1svEf54Yra13oS76R8W6J5jrGs11dpj4sQan0Ps4Uoek/edit#"
                    >
                        <div class="feedback-hint">
                            [internal, for Googlers]
                        </div>
                        Give feedback
                    </a>
                </button>
            </div>
        </div>
        <!-- SIMPLE MODE START -->
        <div id="simple-mode" class="mode-section">
            <div class="launch-panel">
                <div class="launch-panel-content-wrapper">
                    <h2>Parameters</h2>
                    <div>
                        <h3>API parameters</h3>
                        <div>
                            <label for="contribution-budget"
                                >Contribution budget:</label
                            >
                            <span id="contribution-budget"></span>
                            <div class="help" id="help-budget"></div>
                        </div>
                        <div>
                            <label>Epsilon:</label>
                            <input
                                type="number"
                                max="64"
                                min="0"
                                value="10"
                                id="eps"
                                oninput="capEpsilon(event, this)"
                            />
                            <div class="help" id="help-epsilon"></div>
                            <div class="input-hint">Min: 0, Max: 64</div>
                        </div>
                    </div>
                    <div>
                        <h3>Your Attribution Reporting strategy</h3>
                        <div>
                            <label for="batching-frequency"
                                >Batching frequency:</label
                            >
                            <select
                                name="batching-frequency"
                                id="batching-frequency-select"
                            ></select>
                            <div
                                class="help"
                                id="help-batching-frequency"
                            ></div>
                            <!-- Options are populated automatically -->
                        </div>
                        <div>
                            <label for="key-strategy">Key strategy:</label>
                            <select
                                name="key-strategy"
                                id="key-strategy-select"
                                disabled
                            ></select>
                            <div class="help" id="help-key-strategy"></div>
                            <div class="input-hint">
                                Only Strategy A is available in the simple mode.
                                Try Strategy B in the advanced mode.
                            </div>
                            <!-- Options are populated automatically -->
                        </div>
                        <div>
                            <label for="scaling">Scaling:</label>
                            <select name="scaling" id="scaling">
                                <option value="1">Yes</option>
                                <option value="0">No</option>
                            </select>
                            <div class="help" id="help-scaling"></div>
                        </div>
                    </div>
                    <div>
                        <h3>Your conversion data</h3>
                        <div>
                            <label for="daily"
                                >Average daily attributable conversion
                                count:</label
                            >
                            <select name="daily" id="daily">
                                <option value="10">10</option>
                                <option value="100" selected>100</option>
                                <option value="1000">1000</option>
                                <option value="10000">10000</option>
                            </select>
                            <div class="help" id="help-daily"></div>
                        </div>
                    </div>
                    <div>
                        <h3>Data you want to track</h3>
                        <div>
                            <label for="metrics"
                                >Measurement goals to track:</label
                            >
                            <div id="metrics"></div>
                        </div>
                        <div>
                            <label for="dimensions">Dimensions to track:</label>
                            <div id="dimensions-table"></div>
                        </div>
                    </div>
                </div>

                <div class="buttons-wrapper-launch-panel">
                    <button
                        id="button-simulate"
                        onclick="simulateAndDisplayResultsSimpleMode()"
                    >
                        ‚ñ∂Ô∏è SIMULATE
                    </button>
                    <button
                        class="secondary destructive"
                        onclick="clearAllSimpleMode()"
                    >
                        üóë CLEAR ALL SIMULATIONS
                    </button>
                </div>
            </div>
            <main>
                <h2>Simulations</h2>
                <div id="all-simulations-wrapper-simple-mode"></div>
            </main>
        </div>
        <!-- SIMPLE MODE END -->
        <!-- ADVANCED MODE START -->
        <div id="advanced-mode" class="mode-section">
            <div class="launch-panel">
                <div class="launch-panel-content-wrapper">
                    <h2>Parameters</h2>
                    <div>
                        <h3>API Parameters</h3>
                        <div>
                            <label for="contribution-budget"
                                >Contribution budget:</label
                            >
                            <span id="contribution-budget"></span>
                            <div class="help" id="help-budget"></div>
                        </div>
                        <div>
                            <label>Epsilon:</label>
                            <input
                                type="number"
                                max="64"
                                min="0"
                                value="10"
                                id="eps"
                                oninput="capEpsilon(event, this)"
                            />
                            <div class="help" id="help-epsilon"></div>
                            <div class="input-hint">Min: 0, Max: 64</div>
                        </div>
                    </div>
                    <div>
                        <h3>Your Attribution Reporting strategy</h3>
                        <label for="frequency">Batching frequency:</label>
                        <select name="frequency" id="frequency">
                            <option value="0.04167">Hourly</option>
                            <option value="1">Daily</option>
                            <option value="7">Weekly</option>
                            <option value="30">Monthly</option>
                        </select>
                        <div class="help" id="help-batching-frequency"></div>
                        <br />
                        <label for="daily"
                            >Average daily attributable conversion count:</label
                        >
                        <select name="daily" id="daily">
                            <option value="10">10</option>
                            <option value="100" selected>100</option>
                            <option value="1000">1000</option>
                            <option value="10000">10000</option>
                        </select>

                        <div class="help" id="help-daily"></div>
                        <br />
                        <label for="granularity">Key strategy:</label>
                        <select name="granularity" id="granularity">
                            <option value="A">A</option>
                            <option value="B">B</option>
                        </select>
                        <div class="help" id="help-key-strategy"></div>
                        <br />

                        <label for="scaling">Scaling:</label>
                        <select name="scaling" id="scaling">
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                        <div class="help" id="help-scaling"></div>
                    </div>
                    <div id="metrics-params">
                        <h3>Measurement goals</h3>
                        <details open>
                            <summary>
                                <div class="ternary-xs">
                                    Show/Hide measurement goals
                                </div>
                            </summary>
                            <div class="details-wrapper">
                                <label> Number of goals</label
                                ><input
                                    type="number"
                                    value="2"
                                    id="metrics-number"
                                    max="64"
                                    min="0"
                                />
                                <br />
                                <div id="metrics-div"></div>
                                <div id="metrics-buttons-div"></div>
                            </div>
                        </details>
                    </div>
                    <div id="dimensions">
                        <h3>Dimensions to track</h3>
                        <details open>
                            <summary>
                                <div class="ternary-xs">
                                    Show/Hide dimensions
                                </div>
                            </summary>
                            <div class="details-wrapper">
                                <label>Number of dimensions to track:</label>
                                <input
                                    type="number"
                                    id="dimensions-number"
                                    name="dimensions-number"
                                    max="64"
                                    min="0"
                                />
                                <div id="dimensions-div"></div>
                                <div id="dimensions-buttons-div"></div>
                            </div>
                        </details>
                        <br />
                    </div>
                    <br />
                    <div id="granular" hidden>
                        <h2>Key structures</h2>

                        <label
                            >Enter number of key structures you want to
                            use:</label
                        >
                        <input
                            type="number"
                            id="structures-number"
                            name="structures-number"
                            max="64"
                            min="0"
                            value="1"
                        />
                        <button onclick="generateKeyStrategies()">
                            Submit
                        </button>
                        <div id="strategies"></div>
                    </div>
                </div>
                <div class="buttons-wrapper-launch-panel">
                    <button onclick="simulateAndDisplayResultsAdvancedMode()">
                        ‚ñ∂Ô∏è SIMULATE
                    </button>
                    <button
                        class="secondary destructive"
                        onclick="clearAllAdvancedMode()"
                    >
                        üóë CLEAR ALL SIMULATIONS
                    </button>
                </div>
            </div>
            <main>
                <h2>Simulations</h2>
                <div id="all-simulations-wrapper-advanced-mode"></div>
            </main>
        </div>
        <div class="save-section">
            Make sure to <strong>‚¨áÔ∏è Download</strong> your simulations.
            Simulations are not saved in your browser or persisted in any way,
            so they'll be deleted when you switch between modes or when you
            close Noise Lab.
        </div>
    </body>
</html>
