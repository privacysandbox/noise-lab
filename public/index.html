<!DOCTYPE html>
<html>
    <head>
        <title>üß™ Noise Lab</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script type="module" src="js/main.js" defer></script>
        <script type="module" src="js/laplace.js" defer></script>
        <script type="module" src="js/simple-mode.js" defer></script>
        <script type="module" src="js/tooltips.js" defer></script>
        <link rel="stylesheet" href="./style.css" />
        <link href="./third_party/tabulator.min.css" rel="stylesheet" />
    </head>

    <body>
        <div id="menu">
            <nav id="nav">
                <div>
                    üß™ Noise Lab
                    <div class="version">v1.0.1</div>
                </div>

                <!-- Populated automatically, see main.js -->
            </nav>
            <div>
                <button class="secondary">
                    <a
                        target="_blank"
                        href="https://github.com/WICG/attribution-reporting-api/issues/485"
                    >
                        <div class="feedback-hint">[external button]</div>

                        Share your obervations <br />
                        / Give feedback
                    </a>
                </button>
                <button id="feedback-button" class="secondary">
                    <a
                        target="_blank"
                        href="https://docs.google.com/document/d/1svEf54Yra13oS76R8W6J5jrGs11dpj4sQan0Ps4Uoek/edit#"
                    >
                        <div class="feedback-hint">
                            [internal button to gather Googler <br />
                            feedback in the prototyping phase]
                        </div>
                        Give feedback / Ask a question
                    </a>
                </button>
            </div>
        </div>
        <!-- SIMPLE MODE START -->
        <div id="simple-mode" class="mode-section">
            <div class="launch-panel">
                <div class="launch-panel-content-wrapper">
                    <h2>Parameters</h2>
                    <div>
                        <hr />
                        <h3>API parameters</h3>
                        <div>
                            <label for="contribution-budget"
                                >Contribution budget:</label
                            >
                            <span id="contribution-budget"></span>
                            <div class="help" id="help-budget"></div>
                        </div>
                        <div>
                            <label>Epsilon:</label>
                            <input
                                type="number"
                                max="64"
                                min="0"
                                value="10"
                                id="eps"
                                oninput="capEpsilon(event, this)"
                            />
                            <div class="help" id="help-epsilon"></div>
                            <div class="input-hint">Min: 0, Max: 64</div>
                        </div>
                    </div>
                    <div>
                        <hr />
                        <h3>Your Attribution Reporting strategy</h3>
                        <div>
                            <label for="batching-frequency"
                                >Batching frequency:</label
                            >
                            <select
                                name="batching-frequency"
                                id="batching-frequency-select"
                            ></select>
                            <div
                                class="help"
                                id="help-batching-frequency"
                            ></div>
                            <!-- Options are populated automatically -->
                        </div>
                        <div>
                            <label for="key-strategy">Key strategy:</label>
                            <select
                                name="key-strategy"
                                id="key-strategy-select"
                                disabled
                            ></select>
                            <div class="help" id="help-key-strategy"></div>
                            <div class="input-hint">
                                Only Strategy A is available in the simple mode.
                                Try Strategy B in the advanced mode.
                            </div>
                            <!-- Options are populated automatically -->
                        </div>
                        <div>
                            <label for="scaling">Scaling:</label>
                            <select name="scaling" id="scaling">
                                <option value="1">Yes</option>
                                <option value="0">No</option>
                            </select>
                            <div class="help" id="help-scaling"></div>
                        </div>
                    </div>
                    <div>
                        <hr />
                        <h3>Your conversion data</h3>
                        <div>
                            <label for="daily"
                                >Average daily attributable conversion
                                count:</label
                            >
                            <select name="daily" id="daily">
                                <option value="10">10</option>
                                <option value="100" selected>100</option>
                                <option value="1000">1000</option>
                                <option value="10000">10000</option>
                            </select>
                            <div class="help" id="help-daily"></div>
                        </div>
                    </div>
                    <div>
                        <hr />
                        <h3>Data you want to track</h3>
                        <div>
                            <label for="metrics"
                                >Measurement goals to track:</label
                            >
                            <div id="metrics"></div>
                        </div>
                        <div>
                            <label for="dimensions">Dimensions to track:</label>
                            <div id="dimensions-table"></div>
                        </div>
                    </div>
                </div>

                <div class="buttons-wrapper-launch-panel">
                    <button
                        id="button-simulate"
                        onclick="simulateAndDisplayResultsSimpleMode()"
                    >
                        ‚ñ∂Ô∏è SIMULATE
                    </button>
                    <button
                        class="secondary destructive"
                        onclick="clearAllSimpleMode()"
                    >
                        üóë CLEAR ALL SIMULATIONS
                    </button>
                </div>
            </div>
            <main>
                <h2>Simulations</h2>
                <div id="all-simulations-wrapper-simple-mode"></div>
            </main>
        </div>
        <!-- SIMPLE MODE END -->
        <!-- ADVANCED MODE START -->
        <div id="advanced-mode" class="mode-section">
            <div class="launch-panel">
                <div class="launch-panel-content-wrapper">
                    <h2>Parameters</h2>
                    <div>
                        <hr />
                        <h3>API Parameters</h3>
                        <div>
                            <label for="contribution-budget"
                                >Contribution budget:</label
                            >
                            <span id="contribution-budget"></span>
                            <div class="help" id="help-budget"></div>
                        </div>
                        <div>
                            <label>Epsilon:</label>
                            <input
                                type="number"
                                max="64"
                                min="0"
                                value="10"
                                id="eps"
                                oninput="capEpsilon(event, this)"
                            />
                            <div class="help" id="help-epsilon"></div>
                            <div class="input-hint">Min: 0, Max: 64</div>
                        </div>
                    </div>
                    <hr />
                    <div>
                        <h3>Your Attribution Reporting strategy</h3>
                        <label for="frequency">Batching frequency:</label>
                        <select name="frequency" id="frequency">
                            <option value="0.4167">Hourly</option>
                            <option value="1">Daily</option>
                            <option value="7">Weekly</option>
                            <option value="30">Monthly</option>
                        </select>
                        <div class="help" id="help-batching-frequency"></div>
                        <br />
                        <label for="daily"
                            >Average daily attributable conversion count:</label
                        >
                        <select name="daily" id="daily">
                            <option value="10">10</option>
                            <option value="100" selected>100</option>
                            <option value="1000">1000</option>
                            <option value="10000">10000</option>
                        </select>

                        <div class="help" id="help-daily"></div>
                        <br />
                        <label for="granularity">Key strategy:</label>
                        <select name="granularity" id="granularity">
                            <option value="A">A</option>
                            <option value="B">B</option>
                        </select>
                        <div class="help" id="help-key-strategy"></div>
                        <br />

                        <label for="scaling">Scaling:</label>
                        <select name="scaling" id="scaling">
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                        <div class="help" id="help-scaling"></div>
                    </div>
                    <hr />
                    <div id="metrics-params">
                        <h3>Measurement goals</h3>
                        <details open>
                            <summary>
                                <div class="ternary-xs">
                                    Show/Hide measurement goals
                                </div>
                            </summary>
                            <div class="details-wrapper">
                                <label> Number of goals</label
                                ><input
                                    type="number"
                                    value="2"
                                    id="metrics-number"
                                    max="64"
                                    min="0"
                                />
                                <br />
                                <div id="metrics-div"></div>
                                <div id="metrics-buttons-div"></div>
                            </div>
                        </details>
                    </div>

                    <hr />

                    <div id="dimensions">
                        <h3>Dimensions to track</h3>
                        <details open>
                            <summary>
                                <div class="ternary-xs">
                                    Show/Hide dimensions
                                </div>
                            </summary>
                            <div class="details-wrapper">
                                <label>Number of dimensions to track:</label>
                                <input
                                    type="number"
                                    id="dimensions-number"
                                    name="dimensions-number"
                                    max="64"
                                    min="0"
                                />
                                <div id="dimensions-div"></div>
                                <div id="dimensions-buttons-div"></div>
                            </div>
                        </details>
                        <br />
                    </div>
                    <br />

                    <div id="granular" hidden>
                        <hr />
                        <h2>Key structures</h2>

                        <label
                            >Enter number of key structures you want to
                            use:</label
                        >
                        <input
                            type="number"
                            id="structures-number"
                            name="structures-number"
                            max="64"
                            min="0"
                            value="1"
                        />
                        <button onclick="generateKeyStrategies()">
                            Submit
                        </button>
                        <div id="strategies"></div>
                    </div>
                </div>
                <div class="buttons-wrapper-launch-panel">
                    <button onclick="triggerSimulation()">‚ñ∂Ô∏è SIMULATE</button>
                    <button
                        class="secondary destructive"
                        onclick="clearAllAdvancedMode()"
                    >
                        üóë CLEAR ALL SIMULATIONS
                    </button>
                </div>
            </div>
            <main>
                <h2>Simulations</h2>
                <div id="all-simulations-wrapper-advanced-mode"></div>
            </main>
        </div>
    </body>
</html>
